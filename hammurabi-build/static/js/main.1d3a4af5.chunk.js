(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),i=n(8),o=n.n(i),r=n(1),c=n(2),l=n(4),u=n(3),h=n(5),m=function(){return fetch("/api/get-songs").then(function(e){return e.json()})},d=(n(15),n(6)),b=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.data.body_html;return s.a.createElement("div",{className:"Comment",dangerouslySetInnerHTML:{__html:e}})}}]),t}(s.a.Component),g=(n(16),function(e){function t(e){var n;Object(r.a)(this,t),n=Object(l.a)(this,Object(u.a)(t).call(this,e));var a=e.comments.map(function(e){return{enabled:!1,data:e}});return n.state={current:0,settings:a},n.onSubmit=n.onSubmit.bind(Object(d.a)(n)),n.handle=n.handle.bind(Object(d.a)(n)),n.toggleCurrent=n.toggleCurrent.bind(Object(d.a)(n)),n.handleKeyEvent=n.handleKeyEvent.bind(Object(d.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"handleKeyEvent",value:function(e){switch(console.log(e.code),e.code){case"KeyA":case"ArrowLeft":this.goPrev();break;case"KeyD":case"ArrowRight":this.goNext();break;case"KeyE":case"Space":this.toggleCurrent();break;case"Enter":this.onSubmit()}}},{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyEvent)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyEvent)}},{key:"goPrev",value:function(){this.state.current>0&&this.setState({current:this.state.current-1})}},{key:"goNext",value:function(){this.state.current<this.state.settings.length-1&&this.setState({current:this.state.current+1})}},{key:"onSubmit",value:function(){var e=this.state.settings.filter(function(e){return e.enabled});this.props.onSelection(e)}},{key:"handle",value:function(e){this.state.chosen.has(e)?this.state.chosen.set(e):this.state.chosen.add(e),this.setState({chosen:this.state.chosen})}},{key:"toggleCurrent",value:function(){var e=this.state.settings,t=e[this.state.current];t.enabled=!t.enabled,e[this.state.current]=t,console.log(e[this.state.current]),this.setState({settings:e})}},{key:"render",value:function(){var e=this,t=this.state.settings[this.state.current].data,n=this.state.settings.filter(function(e){return e.enabled}).length;return s.a.createElement("div",{className:"Comments"},s.a.createElement("div",null,s.a.createElement(b,{data:t}),s.a.createElement("div",{className:"options"},s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:this.state.settings[this.state.current].enabled,onChange:this.toggleCurrent.bind(this)}),"Enable")),s.a.createElement("div",{className:"controls"},s.a.createElement("button",{disabled:this.state.current<=0,onClick:this.goPrev.bind(this)},"Prev"),s.a.createElement("input",{style:{width:60},type:"number",value:this.state.current+1,onChange:function(t){return e.setState({current:Math.max(0,parseInt(t.target.value)-1||0)})}}),s.a.createElement("button",{disabled:this.state.current>this.state.settings.length,onClick:this.goNext.bind(this)},"Next")),s.a.createElement("div",{className:"controls"},s.a.createElement("span",null,n," ",1===n?"comment":"comments"," selected"),s.a.createElement("button",{onClick:this.onSubmit},"Finish"))))}}]),t}(s.a.Component)),v=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={thread:""},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"onSubmit",value:function(e){e.preventDefault(),this.props.onSelection(this.state.thread)}},{key:"handle",value:function(e){this.setState({thread:e.target.value})}},{key:"render",value:function(){return s.a.createElement("div",{className:"Thread"},s.a.createElement("h1",null,"Choose a thread"),s.a.createElement("form",{onSubmit:this.onSubmit.bind(this)},s.a.createElement("input",{value:this.state.thread,onChange:this.handle.bind(this),placeholder:"Choose a thread",autoFocus:!0}),s.a.createElement("button",null,"OK")))}}]),t}(s.a.Component),f=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={song:null,songs:null},m().then(function(e){n.setState({songs:e,song:e[0]})}),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"onSubmit",value:function(e){e.preventDefault(),this.props.onSelection({song:this.state.song})}},{key:"changeSong",value:function(e){console.log(e.target.value)}},{key:"render",value:function(){return s.a.createElement("div",{className:"Thread"},s.a.createElement("form",{onSubmit:this.onSubmit.bind(this)},this.state.songs&&s.a.createElement("select",{onChange:this.changeSong.bind(this)},this.state.songs.map(function(e){return s.a.createElement("option",{key:e},e)})),s.a.createElement("br",null),s.a.createElement("button",{type:"submit"},"Send to the slaughterhouse")))}}]),t}(s.a.Component),p=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={stage:0,comments:[],question:null,processed:null,options:{song:null}},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"fetchThread",value:function(e){var t=this;(function(e){return fetch("/api/get-thread/"+e).then(function(e){return e.json()})})(e).then(function(e){t.setState({question:e[0],comments:e[1],stage:1})})}},{key:"commentsDone",value:function(e){console.log(e),this.setState({processed:e,stage:2})}},{key:"addSettings",value:function(e){this.setState({options:e,stage:3}),function(e,t,n){fetch("/api/render-video",{method:"POST",body:JSON.stringify({questionData:e,commentData:t,options:n})}).then(function(e){return e.json()})}(this.state.question,this.state.processed,e)}},{key:"render",value:function(){return 0===this.state.stage?s.a.createElement("div",{className:"App"},s.a.createElement(v,{onSelection:this.fetchThread.bind(this)})):1===this.state.stage?s.a.createElement("div",{className:"App"},s.a.createElement(g,{onSelection:this.commentsDone.bind(this),comments:this.state.comments})):2===this.state.stage?s.a.createElement("div",{className:"App"},s.a.createElement(f,{onSelection:this.addSettings.bind(this)})):3===this.state.stage?s.a.createElement("div",{className:"App"},s.a.createElement("h1",null,"rendering atm bro"),s.a.createElement("p",null,"You may close this tab")):void 0}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(p,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,n){e.exports=n(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.1d3a4af5.chunk.js.map